<%= render Maglev::Uikit::PageLayoutComponent.new(expanded: true, back_path: editor_root_path(maglev_editing_route_context)) do |page_layout| %>
  <% page_layout.with_title_content @section.blocks_label %>
  <% page_layout.with_notification_content maglev_flash_message %>

  <% page_layout.with_pre_title do %>
    <%= render Maglev::Uikit::Breadcrumbs::BreadcrumbsComponent.new do |breadcrumbs| %>
      <% breadcrumbs.with_breadcrumb(label: 'Sections', url: editor_sections_path(maglev_editing_route_context), icon: 'stack') %>
      <% breadcrumbs.with_breadcrumb(label: truncate(@section.type_name, length: 20), url: edit_editor_section_path(@section, maglev_editing_route_context), icon: 'settings') %>
    <% end %>
  <% end %>

  <% if @section.definition.blocks_tree? %>
    <p>TODO</p>
  <% else %>
    <%= render 'list' %>
  <% end %>

  <% page_layout.with_footer do %>
    <% if @section.definition.blocks_tree? %>
      <p>TODO</p>
    <% else %>
      <%= button_to t('maglev.editor.section_blocks.index.add_button'),
        editor_section_blocks_path(@section, block_type: @section.definition.blocks.first.type, **maglev_editing_route_context), 
        class: maglev_button_classes(size: :big),
        method: :post,
        name: 'add_section_block',
        form: {
          data: { 
            turbo_frame: '_top',
            action: 'turbo:submit-end->editor-preview-notification-center#addSectionBlock',
            'editor-preview-notification-center-section-id-param': @section.id,
          } 
        }%>
    <% end %>
  <% end %>
<% end %>