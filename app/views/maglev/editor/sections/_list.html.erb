<%= render Maglev::Uikit::List::ListComponent.new(
    sort_form: { 
      path: sort_editor_sections_path(store_id: sections_store, lock_version: sections_store.lock_version, **maglev_editing_route_context), 
      data: { 
        turbo_frame: '_top',
        action: 'sortable:drag-stopped@window->editor-preview-notification-center#moveSection',            
      } 
    }) do |component| %>

  <% if sections_store.can_add_sections? %>
    <% component.with_item_insert_button(link: { url: new_editor_section_path(store_id: sections_store, position: 0, **maglev_editing_route_context), data: { turbo_frame: '_top' } })%>
  <% end %>
  
  <% sections_store.sections.each_with_index do |section, index| %>
    <% component.with_item_content(id: section.id, link: { url: edit_editor_section_path(section.id, maglev_editing_route_context), data: { turbo_frame: '_top' } }) do |item| %>
      <% item.with_handle %>

      <% if section.label? %>
        <% item.with_pre_title do %>
          <%= section.type_name %>
          <%= render Maglev::Uikit::IconComponent.new(name: "text_link", size: "0.7rem") if section.mirrored? %>
        <% end %>
        <% item.with_title_content(section.label) %>
      <% else %>
        <% item.with_title_content(section.type_name) %>
      <% end %>

      <% item.with_action do %>
        <%= button_to editor_section_path(section.id, maglev_editing_route_context), 
          method: :delete, 
          class: maglev_icon_button_classes, 
          data: { 
            turbo_confirm: t('maglev.editor.sections.index.confirm_delete')
          }, 
          form: { 
            data: {
              action: 'turbo:submit-end->editor-preview-notification-center#deleteSection',
              'editor-preview-notification-center-section-id-param': section.id
            }
          } do %>
          <%= render Maglev::Uikit::IconComponent.new(name: "delete_bin", size: "1.15rem") %>
        <% end %>
      <% end %>
    <% end %>
    
    <% if sections_store.can_add_sections? %>
      <% component.with_item_insert_button(link: { url: new_editor_section_path(store_id: sections_store, position: index + 1, **maglev_editing_route_context), data: { turbo_frame: '_top' } }) %> 
    <% end %>
  <% end %>
<% end %>